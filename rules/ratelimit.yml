rules:
  rate-limit-header:
    description: |-
      APIs should use ratelimit headers.
      See https://docs.italia.it/italia/piano-triennale-ict/lg-modellointeroperabilita-docs/it/bozza/doc/profili-di-interazione/robustezza.html#segnalare-raggiunti-limiti-di-utilizzo
    message: |-
      {{property}} does not have ratelimit {{error}}
    formats:
      - oas3
    severity: warn
    recommended: true
    given: >-
      $.[responses][*]['headers']
    then:
      field: X-RateLimit-Limit
      function: truthy